---

title: Transform Errors


keywords: fastai
sidebar: home_sidebar

summary: "General errors for dealing with `Transform`s"
description: "General errors for dealing with `Transform`s"
nb_path: "03_fastai.transform.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_fastai.transform.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/mnt/d/lib/python3.7/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /pytorch/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() &gt; 0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Transform errors are currently some of the hardest to debug, including the dreaded <code>Could not do one pass through your DataLoader</code>.</p>
<p>This module provides some extra errors and injection points to see the full traces and their causes</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="transform_error" class="doc_header"><code>transform_error</code><a href="https://github.com/muellerzr/fastdebug/tree/master/fastdebug/fastai/transform.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>transform_error</code>(<strong><code>e</code></strong>:<code>Exception</code>, <strong><code>nm</code></strong>:<code>str</code>, <strong><code>event</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Raises Exception <code>e</code> stemming from a Transform with more information</p>
<ul>
<li><code>nm</code>: The name of the Transform</li>
<li><code>event</code>: The event called (such as <code>encodes</code> or <code>decodes</code>)</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Transform.__call__" class="doc_header"><code>Transform.__call__</code><a href="https://github.com/muellerzr/fastdebug/tree/master/fastdebug/fastai/transform.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Transform.__call__</code>(<strong><code>x</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Call self as a function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Transform.decode" class="doc_header"><code>Transform.decode</code><a href="https://github.com/muellerzr/fastdebug/tree/master/fastdebug/fastai/transform.py#L35" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Transform.decode</code>(<strong><code>x</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Delegate to <code>decodes</code> to undo transform</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/fastdebug/fastai.transform.html#transform_error"><code>transform_error</code></a> is extremely useful for trying to figure out what section of your pipeline broke.</p>
<p>As an example, we'll write a broken transform and attempt to build a <code>DataLoader</code> with it.
{% include note.html content='We have added in the capability to get a more verbose error message when building the <code>DataLoaders</code> inplace with this module. Check the source notebook or code to see the <code>@patch</code>&#8217;d code' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TfmdDL.new" class="doc_header"><code>TfmdDL.new</code><a href="https://github.com/muellerzr/fastdebug/tree/master/fastdebug/fastai/transform.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TfmdDL.new</code>(<strong><code>dataset</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create a new version of self with a few changed attributes</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">BrokenTransform</span><span class="p">(</span><span class="n">DisplayedTransform</span><span class="p">):</span>
    <span class="s2">&quot;A purposefully broken transform&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
    <span class="k">def</span> <span class="nf">encodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">TensorImage</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;images&#39;</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_name_func</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">label_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">(),</span>
    <span class="n">item_tfms</span><span class="o">=</span><span class="p">[</span><span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">)],</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="p">[</span><span class="n">BrokenTransform</span><span class="p">()])</span>

<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your DataLoader, there is something wrong in it. Please see the stack trace below:
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-33-07c095d99b52&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     path<span class="ansi-blue-fg">,</span> get_image_files<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> valid_pct<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.2</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     label_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">lambda</span> x<span class="ansi-blue-fg">:</span> x<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>isupper<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg">     item_tfms=[Resize(224)], batch_tfms=[BrokenTransform()])
</span><span class="ansi-green-intense-fg ansi-bold">      7</span> 
<span class="ansi-green-intense-fg ansi-bold">      8</span> x<span class="ansi-blue-fg">,</span>y <span class="ansi-blue-fg">=</span> dls<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/vision/data.py</span> in <span class="ansi-cyan-fg">from_name_func</span><span class="ansi-blue-fg">(cls, path, fnames, label_func, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    119</span>             <span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;label_func couldn&#39;t be lambda function on Windows&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    120</span>         f <span class="ansi-blue-fg">=</span> using_attr<span class="ansi-blue-fg">(</span>label_func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;name&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 121</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>from_path_func<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">,</span> fnames<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    122</span> 
<span class="ansi-green-intense-fg ansi-bold">    123</span>     <span class="ansi-blue-fg">@</span>classmethod

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/vision/data.py</span> in <span class="ansi-cyan-fg">from_path_func</span><span class="ansi-blue-fg">(cls, path, fnames, label_func, valid_pct, seed, item_tfms, batch_tfms, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    110</span>                            item_tfms<span class="ansi-blue-fg">=</span>item_tfms<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    111</span>                            batch_tfms=batch_tfms)
<span class="ansi-green-fg">--&gt; 112</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>from_dblock<span class="ansi-blue-fg">(</span>dblock<span class="ansi-blue-fg">,</span> fnames<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    113</span> 
<span class="ansi-green-intense-fg ansi-bold">    114</span>     <span class="ansi-blue-fg">@</span>classmethod

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/data/core.py</span> in <span class="ansi-cyan-fg">from_dblock</span><span class="ansi-blue-fg">(cls, dblock, source, path, bs, val_bs, shuffle, device, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    193</span>     <span class="ansi-blue-fg">@</span>classmethod
<span class="ansi-green-intense-fg ansi-bold">    194</span>     <span class="ansi-green-fg">def</span> from_dblock<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> dblock<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;.&#39;</span><span class="ansi-blue-fg">,</span>  bs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span> val_bs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 195</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> dblock<span class="ansi-blue-fg">.</span>dataloaders<span class="ansi-blue-fg">(</span>source<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> bs<span class="ansi-blue-fg">=</span>bs<span class="ansi-blue-fg">,</span> val_bs<span class="ansi-blue-fg">=</span>val_bs<span class="ansi-blue-fg">,</span> shuffle<span class="ansi-blue-fg">=</span>shuffle<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span> 
<span class="ansi-green-intense-fg ansi-bold">    197</span>     _docs=dict(__getitem__=&#34;Retrieve `DataLoader` at `i` (`0` is training, `1` is validation)&#34;,

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/data/block.py</span> in <span class="ansi-cyan-fg">dataloaders</span><span class="ansi-blue-fg">(self, source, path, verbose, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    113</span>         dsets <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>datasets<span class="ansi-blue-fg">(</span>source<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span>verbose<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    114</span>         kwargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">**</span>self<span class="ansi-blue-fg">.</span>dls_kwargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;verbose&#39;</span><span class="ansi-blue-fg">:</span> verbose<span class="ansi-blue-fg">}</span>
<span class="ansi-green-fg">--&gt; 115</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> dsets<span class="ansi-blue-fg">.</span>dataloaders<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> after_item<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>item_tfms<span class="ansi-blue-fg">,</span> after_batch<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>batch_tfms<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span> 
<span class="ansi-green-intense-fg ansi-bold">    117</span>     _docs = dict(new=&#34;Create a new `DataBlock` with other `item_tfms` and `batch_tfms`&#34;,

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/data/core.py</span> in <span class="ansi-cyan-fg">dataloaders</span><span class="ansi-blue-fg">(self, bs, shuffle_train, shuffle, val_shuffle, n, path, dl_type, dl_kwargs, device, drop_last, val_bs, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    235</span>         def_kwargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">&#39;bs&#39;</span><span class="ansi-blue-fg">:</span>bs <span class="ansi-green-fg">if</span> val_bs <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> val_bs<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;shuffle&#39;</span><span class="ansi-blue-fg">:</span>val_shuffle<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;n&#39;</span><span class="ansi-blue-fg">:</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;drop_last&#39;</span><span class="ansi-blue-fg">:</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">}</span>
<span class="ansi-green-intense-fg ansi-bold">    236</span>         dls = [dl] + [dl.new(self.subset(i), **merge(kwargs,def_kwargs,val_kwargs,dl_kwargs[i]))
<span class="ansi-green-fg">--&gt; 237</span><span class="ansi-red-fg">                       for i in range(1, self.n_subsets)]
</span><span class="ansi-green-intense-fg ansi-bold">    238</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_dbunch_type<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>dls<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/data/core.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    235</span>         def_kwargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">&#39;bs&#39;</span><span class="ansi-blue-fg">:</span>bs <span class="ansi-green-fg">if</span> val_bs <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> val_bs<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;shuffle&#39;</span><span class="ansi-blue-fg">:</span>val_shuffle<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;n&#39;</span><span class="ansi-blue-fg">:</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;drop_last&#39;</span><span class="ansi-blue-fg">:</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">}</span>
<span class="ansi-green-intense-fg ansi-bold">    236</span>         dls = [dl] + [dl.new(self.subset(i), **merge(kwargs,def_kwargs,val_kwargs,dl_kwargs[i]))
<span class="ansi-green-fg">--&gt; 237</span><span class="ansi-red-fg">                       for i in range(1, self.n_subsets)]
</span><span class="ansi-green-intense-fg ansi-bold">    238</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_dbunch_type<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>dls<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span> 

<span class="ansi-green-fg">&lt;ipython-input-31-c6b453e54b12&gt;</span> in <span class="ansi-cyan-fg">new</span><span class="ansi-blue-fg">(self, dataset, cls, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>         <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>             print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Could not do one pass in your DataLoader, there is something wrong in it. Please see the stack trace below:&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 13</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> e
<span class="ansi-green-intense-fg ansi-bold">     14</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span> res<span class="ansi-blue-fg">.</span>_n_inp<span class="ansi-blue-fg">,</span>res<span class="ansi-blue-fg">.</span>_types <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_n_inp<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>_types
<span class="ansi-green-intense-fg ansi-bold">     15</span>     <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">&lt;ipython-input-31-c6b453e54b12&gt;</span> in <span class="ansi-cyan-fg">new</span><span class="ansi-blue-fg">(self, dataset, cls, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> hasattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;_n_inp&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> <span class="ansi-green-fg">not</span> hasattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;_types&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 9</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_one_pass<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span>             res<span class="ansi-blue-fg">.</span>_n_inp<span class="ansi-blue-fg">,</span>res<span class="ansi-blue-fg">.</span>_types <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_n_inp<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>_types
<span class="ansi-green-intense-fg ansi-bold">     11</span>         <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/data/core.py</span> in <span class="ansi-cyan-fg">_one_pass</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>device <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> multiprocessing<span class="ansi-blue-fg">.</span>get_start_method<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>lower<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">&#34;fork&#34;</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     54</span>             b <span class="ansi-blue-fg">=</span> to_device<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 55</span><span class="ansi-red-fg">         </span>its <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>after_batch<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     56</span>         self<span class="ansi-blue-fg">.</span>_n_inp <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span> <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>its<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>list<span class="ansi-blue-fg">,</span>tuple<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> len<span class="ansi-blue-fg">(</span>its<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">==</span><span class="ansi-cyan-fg">1</span> <span class="ansi-green-fg">else</span> len<span class="ansi-blue-fg">(</span>its<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span>         self<span class="ansi-blue-fg">.</span>_types <span class="ansi-blue-fg">=</span> explode_types<span class="ansi-blue-fg">(</span>its<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/transform.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, o)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span>         self<span class="ansi-blue-fg">.</span>fs<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>t<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    197</span> 
<span class="ansi-green-fg">--&gt; 198</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> compose_tfms<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> tfms<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>fs<span class="ansi-blue-fg">,</span> split_idx<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>split_idx<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    199</span>     <span class="ansi-green-fg">def</span> __repr__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">f&#34;Pipeline: {&#39; -&gt; &#39;.join([f.name for f in self.fs if f.name != &#39;noop&#39;])}&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    200</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>i<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>fs<span class="ansi-blue-fg">[</span>i<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/transform.py</span> in <span class="ansi-cyan-fg">compose_tfms</span><span class="ansi-blue-fg">(x, tfms, is_enc, reverse, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    148</span>     <span class="ansi-green-fg">for</span> f <span class="ansi-green-fg">in</span> tfms<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    149</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> is_enc<span class="ansi-blue-fg">:</span> f <span class="ansi-blue-fg">=</span> f<span class="ansi-blue-fg">.</span>decode
<span class="ansi-green-fg">--&gt; 150</span><span class="ansi-red-fg">         </span>x <span class="ansi-blue-fg">=</span> f<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span>     <span class="ansi-green-fg">return</span> x
<span class="ansi-green-intense-fg ansi-bold">    152</span> 

<span class="ansi-green-fg">&lt;ipython-input-29-9e3f8ea9ab42&gt;</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, x, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;encodes&#39;</span><span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>     <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 7</span><span class="ansi-red-fg">         </span>transform_error<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">,</span> _get_name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;encodes&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-28-d548505727b6&gt;</span> in <span class="ansi-cyan-fg">transform_error</span><span class="ansi-blue-fg">(e, nm, event)</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span>     err <span class="ansi-blue-fg">+=</span> e<span class="ansi-blue-fg">.</span>args<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>     e<span class="ansi-blue-fg">.</span>args <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>err<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">---&gt; 12</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">raise</span> e

<span class="ansi-green-fg">&lt;ipython-input-29-9e3f8ea9ab42&gt;</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, x, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">:</span>Transform<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;encodes&#39;</span><span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>     <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>         transform_error<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">,</span> _get_name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;encodes&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/transform.py</span> in <span class="ansi-cyan-fg">_call</span><span class="ansi-blue-fg">(self, fn, x, split_idx, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     81</span>     <span class="ansi-green-fg">def</span> _call<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> fn<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> split_idx<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span>         <span class="ansi-green-fg">if</span> split_idx<span class="ansi-blue-fg">!=</span>self<span class="ansi-blue-fg">.</span>split_idx <span class="ansi-green-fg">and</span> self<span class="ansi-blue-fg">.</span>split_idx <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> x
<span class="ansi-green-fg">---&gt; 83</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_do_call<span class="ansi-blue-fg">(</span>getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> fn<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     84</span> 
<span class="ansi-green-intense-fg ansi-bold">     85</span>     <span class="ansi-green-fg">def</span> _do_call<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/transform.py</span> in <span class="ansi-cyan-fg">_do_call</span><span class="ansi-blue-fg">(self, f, x, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     88</span>             ret <span class="ansi-blue-fg">=</span> f<span class="ansi-blue-fg">.</span>returns<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;returns&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-intense-fg ansi-bold">     89</span>             <span class="ansi-green-fg">return</span> retain_type<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> ret<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 90</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> tuple<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_call<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> x_<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> x_ <span class="ansi-green-fg">in</span> x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     91</span>         <span class="ansi-green-fg">return</span> retain_type<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     92</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/transform.py</span> in <span class="ansi-cyan-fg">&lt;genexpr&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">     88</span>             ret <span class="ansi-blue-fg">=</span> f<span class="ansi-blue-fg">.</span>returns<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;returns&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-intense-fg ansi-bold">     89</span>             <span class="ansi-green-fg">return</span> retain_type<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> ret<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 90</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> tuple<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_call<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> x_<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> x_ <span class="ansi-green-fg">in</span> x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     91</span>         <span class="ansi-green-fg">return</span> retain_type<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     92</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/transform.py</span> in <span class="ansi-cyan-fg">_do_call</span><span class="ansi-blue-fg">(self, f, x, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     87</span>             <span class="ansi-green-fg">if</span> f <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> x
<span class="ansi-green-intense-fg ansi-bold">     88</span>             ret <span class="ansi-blue-fg">=</span> f<span class="ansi-blue-fg">.</span>returns<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;returns&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">---&gt; 89</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> retain_type<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> ret<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span>         res <span class="ansi-blue-fg">=</span> tuple<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_call<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> x_<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> x_ <span class="ansi-green-fg">in</span> x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     91</span>         <span class="ansi-green-fg">return</span> retain_type<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastcore/dispatch.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span>         <span class="ansi-green-fg">elif</span> self<span class="ansi-blue-fg">.</span>inst <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> f <span class="ansi-blue-fg">=</span> MethodType<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>inst<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    117</span>         <span class="ansi-green-fg">elif</span> self<span class="ansi-blue-fg">.</span>owner <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> f <span class="ansi-blue-fg">=</span> MethodType<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>owner<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 118</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    119</span> 
<span class="ansi-green-intense-fg ansi-bold">    120</span>     <span class="ansi-green-fg">def</span> __get__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> inst<span class="ansi-blue-fg">,</span> owner<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">&lt;ipython-input-32-8976e30e4832&gt;</span> in <span class="ansi-cyan-fg">encodes</span><span class="ansi-blue-fg">(self, x)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     <span class="ansi-blue-fg">&#34;A purposefully broken transform&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     y <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;a&#39;</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> encodes<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">:</span>TensorImage<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> x<span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>y

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/fastai/torch_core.py</span> in <span class="ansi-cyan-fg">__torch_function__</span><span class="ansi-blue-fg">(self, func, types, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    327</span>         convert<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">    328</span>         <span class="ansi-green-fg">if</span> _torch_handled<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>_opt<span class="ansi-blue-fg">,</span> func<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> convert<span class="ansi-blue-fg">,</span>types <span class="ansi-blue-fg">=</span> type<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">(</span>torch<span class="ansi-blue-fg">.</span>Tensor<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 329</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__torch_function__<span class="ansi-blue-fg">(</span>func<span class="ansi-blue-fg">,</span> types<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">=</span>args<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">=</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    330</span>         <span class="ansi-green-fg">if</span> convert<span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> convert<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    331</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">,</span> TensorBase<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> res<span class="ansi-blue-fg">.</span>set_meta<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> as_copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/torch/tensor.py</span> in <span class="ansi-cyan-fg">__torch_function__</span><span class="ansi-blue-fg">(cls, func, types, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    993</span> 
<span class="ansi-green-intense-fg ansi-bold">    994</span>         <span class="ansi-green-fg">with</span> _C<span class="ansi-blue-fg">.</span>DisableTorchFunction<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 995</span><span class="ansi-red-fg">             </span>ret <span class="ansi-blue-fg">=</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    996</span>             <span class="ansi-green-fg">return</span> _convert<span class="ansi-blue-fg">(</span>ret<span class="ansi-blue-fg">,</span> cls<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    997</span> 

<span class="ansi-red-fg">TypeError</span>: There was an issue calling the encodes on transform BrokenTransform:

only integer tensors of a single element can be converted to an index</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And as you can see it tells that there was an issue on our <code>encodes</code> for <code>BrokenTransform</code>, which is exactly what we expected to have happen!</p>

</div>
</div>
</div>
</div>
 

